import pymysql.cursors

connection = pymysql.connect(host='localhost',
                             user='root',
                             password='',
                             db='mydb',
                             charset='utf8mb4',
                             cursorclass=pymysql.cursors.DictCursor)


def tablesearch(x, y, z=""):
    try:
        with connection.cursor() as cursor:
            if z is not "":
                sql = "SELECT " + y + " FROM " + x + " WHERE " + z
            else:
                sql = "SELECT " + y + " FROM " + x
            cursor.execute(sql)
            result = cursor.fetchall()
            print(result)
    finally:
        connection.close()


def hey():
    try:
        with connection.cursor() as cursor:
            # Create a new record
            sql = "DELETE FROM `game`  WHERE `Name` LIKE %s"
            cursor.execute(sql, ('Dota_'))

            # connection is not autocommit by default. So you must commit to save your changes.
            connection.commit()

        with connection.cursor() as cursor:
            # Read a single record
            sql = "SELECT matchSize FROM game"
            cursor.execute(sql)
            result = cursor.fetchall()
            print(result)
    finally:
        connection.close()


if __name__ == "__main__":
    tablesearch('team', '`T.name`')

